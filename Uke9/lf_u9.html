<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Løsningsforslag til Fourier II - oppgavene i Python">

<title>Løsningsforslag til Fourier II - oppgavene i Python</title>

<!-- Bootstrap style: bootswatch_yeti -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/yeti/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:45px;      /* fixed header height for style bootswatch_yeti */
  margin:-45px 0 0; /* negative fixed header height */
}

body { font-size:16px; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Oppgave 2', 1, None, '___sec0'),
              ('Oppgave 4', 1, None, '___sec1'),
              ('Oppgave 5', 1, None, '___sec2'),
              ('Oppgave 7', 1, None, '___sec3')]}
end of tocinfo -->

<body>

    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="lf_u9.html">Løsningsforslag til Fourier II - oppgavene i Python</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#___sec0" style="font-size: 14px; padding: 4px 15px;">Oppgave 2</a></li>
     <!-- navigation toc: --> <li><a href="#___sec1" style="font-size: 14px; padding: 4px 15px;">Oppgave 4</a></li>
     <!-- navigation toc: --> <li><a href="#___sec2" style="font-size: 14px; padding: 4px 15px;">Oppgave 5</a></li>
     <!-- navigation toc: --> <li><a href="#___sec3" style="font-size: 14px; padding: 4px 15px;">Oppgave 7</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>L&#248;sningsforslag til Fourier II - oppgavene i Python</h1></center>  <!-- document title -->

<p>
</div> <!-- end jumbotron -->

<h1 id="table_of_contents">Table of contents</h2>

<p>
<a href="#___sec0"> Oppgave 2 </a><br>
<a href="#___sec1"> Oppgave 4 </a><br>
<a href="#___sec2"> Oppgave 5 </a><br>
<a href="#___sec3"> Oppgave 7 </a><br>
</p>
<p>
<!-- !split -->

<h1 id="___sec0" class="anchor">Oppgave 2 </h1>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "friendly" -->
<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">numpy</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">np</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">numpy.fft</span> <span style="color: #007020; font-weight: bold">import</span> fft2,ifft2,fftshift,ifftshift

<span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.pyplot</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">plt</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">scipy.misc</span> <span style="color: #007020; font-weight: bold">import</span> imread

<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">H</span>(D0,P<span style="color: #666666">=</span><span style="color: #40a070">512</span>,Q<span style="color: #666666">=</span><span style="color: #40a070">512</span>):
    H <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((P,Q))
    <span style="color: #007020; font-weight: bold">for</span> u <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(P):
        <span style="color: #007020; font-weight: bold">for</span> v <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(Q):
            D <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sqrt(((u<span style="color: #666666">-</span><span style="color: #40a070">0.5</span><span style="color: #666666">*</span>P)<span style="color: #666666">/</span>(<span style="color: #40a070">0.5</span><span style="color: #666666">*</span>P))<span style="color: #666666">**</span><span style="color: #40a070">2</span><span style="color: #666666">+</span>((v<span style="color: #666666">-</span>Q<span style="color: #666666">*</span><span style="color: #40a070">0.5</span>)<span style="color: #666666">/</span>(Q<span style="color: #666666">*</span><span style="color: #40a070">0.5</span>))<span style="color: #666666">**</span><span style="color: #40a070">2</span>)
            <span style="color: #007020; font-weight: bold">if</span> D <span style="color: #666666">&lt;=</span> D0:
                H[u,v] <span style="color: #666666">=</span> <span style="color: #40a070">1</span>
    <span style="color: #007020; font-weight: bold">return</span> H
    <span style="color: #60a0b0; font-style: italic"># hvis man ønsker å gjøre alt på én linje:</span>
    <span style="color: #60a0b0; font-style: italic"># return np.array([[0 if np.sqrt(((u-0.5*P)/(0.5*P))**2+((v-Q*0.5)/(Q*0.5))**2) &gt; D0 else 1 for v in range(Q)] for u in range(P)])</span>

<span style="color: #60a0b0; font-style: italic"># a</span>
D0 <span style="color: #666666">=</span> <span style="color: #40a070">0.2</span>
H1 <span style="color: #666666">=</span> H(D0)

plt<span style="color: #666666">.</span>figure()
plt<span style="color: #666666">.</span>imshow(H1,cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&quot;Ideelt lavpassfilter med D0 = </span><span style="color: #70a0d0; font-style: italic">%g</span><span style="color: #4070a0"> i frekvensdomenet&quot;</span><span style="color: #666666">%</span>D0)

<span style="color: #60a0b0; font-style: italic"># b og c</span>
H1_idft <span style="color: #666666">=</span> ifftshift(ifft2(fftshift(H1))) <span style="color: #60a0b0; font-style: italic"># fftshift i bildedomenet siden ifft antar DC i [0,0].</span>
                                         <span style="color: #60a0b0; font-style: italic"># Shift så tilbake for presentering av resultatet.</span>

plt<span style="color: #666666">.</span>figure()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>imag(H1_idft),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&quot;Imaginærdel til ideelt lavpassfilter med D0 = </span><span style="color: #70a0d0; font-style: italic">%g</span><span style="color: #4070a0"> i bildedomenet&quot;</span><span style="color: #666666">%</span>D0)
plt<span style="color: #666666">.</span>colorbar()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>real(H1_idft),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&quot;Realdel til ideelt lavpassfilter med D0 = </span><span style="color: #70a0d0; font-style: italic">%g</span><span style="color: #4070a0"> i bildedomenet&quot;</span><span style="color: #666666">%</span>D0)
plt<span style="color: #666666">.</span>colorbar()

<span style="color: #60a0b0; font-style: italic"># d</span>
D0 <span style="color: #666666">=</span> <span style="color: #40a070">0.4</span>
H2 <span style="color: #666666">=</span> H(D0)

H2_idft <span style="color: #666666">=</span> ifftshift(ifft2(fftshift(H2))) <span style="color: #60a0b0; font-style: italic"># fftshift i bildedomenet siden ifft antar DC i [0,0].</span>
                                         <span style="color: #60a0b0; font-style: italic"># Shift så tilbake for presentering av resultatet.</span>

plt<span style="color: #666666">.</span>figure()
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>real(H2_idft),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&quot;Realdel til ideelt lavpassfilter med D0 = </span><span style="color: #70a0d0; font-style: italic">%g</span><span style="color: #4070a0"> i bildedomenet&quot;</span><span style="color: #666666">%</span>D0)
plt<span style="color: #666666">.</span>colorbar()

<span style="color: #60a0b0; font-style: italic"># e</span>
img <span style="color: #666666">=</span> imread(<span style="color: #4070a0">&#39;car.png&#39;</span>,flatten<span style="color: #666666">=</span><span style="color: #007020">True</span>)

img_fft <span style="color: #666666">=</span> fft2(img,[<span style="color: #40a070">512</span>,<span style="color: #40a070">512</span>])

img_H1 <span style="color: #666666">=</span> ifft2(img_fft<span style="color: #666666">*</span>fftshift(H1))
img_H2 <span style="color: #666666">=</span> ifft2(img_fft<span style="color: #666666">*</span>fftshift(H2))

<span style="color: #60a0b0; font-style: italic"># Fjern effekt av nullutviding:</span>
[N,M] <span style="color: #666666">=</span> img<span style="color: #666666">.</span>shape
img_H1 <span style="color: #666666">=</span> img_H1[:N,:M]
img_H2 <span style="color: #666666">=</span> img_H2[:N,:M]

<span style="color: #60a0b0; font-style: italic"># Vis reusltatet etter filtrering</span>
plt<span style="color: #666666">.</span>figure()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>real(img_H1),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Bildet car.png filtrert med H1&#39;</span>)

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>real(img_H2),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Bildet car.png filtrert med H2&#39;</span>)

<span style="color: #60a0b0; font-style: italic"># f</span>
img_hp_H1 <span style="color: #666666">=</span> ifft2(img_fft<span style="color: #666666">*</span>fftshift(<span style="color: #40a070">1</span><span style="color: #666666">-</span>H1))
img_hp_H2 <span style="color: #666666">=</span> ifft2(img_fft<span style="color: #666666">*</span>fftshift(<span style="color: #40a070">1</span><span style="color: #666666">-</span>H2))

<span style="color: #60a0b0; font-style: italic"># Fjern effekt av nullutviding:</span>
[N,M] <span style="color: #666666">=</span> img<span style="color: #666666">.</span>shape
img_hp_H1 <span style="color: #666666">=</span> img_hp_H1[:N,:M]
img_hp_H2 <span style="color: #666666">=</span> img_hp_H2[:N,:M]

<span style="color: #60a0b0; font-style: italic"># Vis resultatet etter filtrering</span>
plt<span style="color: #666666">.</span>figure()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>abs(img_hp_H1),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Bildet car.png filtrert med 1-H1&#39;</span>)

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>abs(img_hp_H2),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Bildet car.png filtrert med 1-H2&#39;</span>)

<span style="color: #60a0b0; font-style: italic"># g</span>
img_H1_add <span style="color: #666666">=</span> img_hp_H1 <span style="color: #666666">+</span> img_H1
img_H2_add <span style="color: #666666">=</span> img_hp_H2 <span style="color: #666666">+</span> img_H2

plt<span style="color: #666666">.</span>figure()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>abs(img_H1_add),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;H1_lavpass + H1_høypass&#39;</span>)

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>abs(img_H2_add),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;H2_lavpass + H2_høypass&#39;</span>)

plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
Programmet kan lastes ned <a href="https://github.com/krisbhei/INF2310/blob/master/Uke9/oppgave2.py" target="_self">her</a>.

<h1 id="___sec1" class="anchor">Oppgave 4 </h1>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "friendly" -->
<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">numpy</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">np</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">numpy.fft</span> <span style="color: #007020; font-weight: bold">import</span> fft2,ifft2,fftshift
<span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.pyplot</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">plt</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">scipy.misc</span> <span style="color: #007020; font-weight: bold">import</span> imread

img <span style="color: #666666">=</span> imread(<span style="color: #4070a0">&#39;forresampling.png&#39;</span>,flatten<span style="color: #666666">=</span><span style="color: #007020">True</span>)

<span style="color: #007020; font-weight: bold">for</span> d <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">1</span>,<span style="color: #40a070">5</span>):
    img_d <span style="color: #666666">=</span> img[::d] <span style="color: #60a0b0; font-style: italic"># hente ut verdier med d mellomrom</span>
    img_d_fft <span style="color: #666666">=</span> fft2(img_d)

    plt<span style="color: #666666">.</span>figure()

    plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
    plt<span style="color: #666666">.</span>imshow(img_d,cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Bildet nedsamplet med d = </span><span style="color: #70a0d0; font-style: italic">%d</span><span style="color: #4070a0"> steg&#39;</span><span style="color: #666666">%</span>d)

    plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
    plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>log(np<span style="color: #666666">.</span>abs(fftshift(img_d_fft))<span style="color: #666666">+</span><span style="color: #40a070">1</span>),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Fourier-spekter til bilde nedsamplet med d = </span><span style="color: #70a0d0; font-style: italic">%d</span><span style="color: #4070a0">&#39;</span><span style="color: #666666">%</span>d)

plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
Programmet kan lastes ned <a href="https://github.com/krisbhei/INF2310/blob/master/Uke9/oppgave4.py" target="_self">her</a>.

<h1 id="___sec2" class="anchor">Oppgave 5 </h1>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "friendly" -->
<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">numpy</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">np</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">numpy.fft</span> <span style="color: #007020; font-weight: bold">import</span> fft2,ifft2,fftshift
<span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.pyplot</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">plt</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">scipy.misc</span> <span style="color: #007020; font-weight: bold">import</span> imread

<span style="color: #60a0b0; font-style: italic"># Lager 2D vindu med størrelse win_size[0] x win_size[1]:</span>
<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">tukeywin</span>(win_size,alpha):

    N,M <span style="color: #666666">=</span> win_size

    h <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((<span style="color: #40a070">2</span>,<span style="color: #007020">max</span>(N,M)))

    <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">2</span>):
        sz <span style="color: #666666">=</span> win_size[i]

        n1 <span style="color: #666666">=</span> <span style="color: #007020">int</span>(<span style="color: #007020">round</span>(alpha<span style="color: #666666">*</span>(sz<span style="color: #666666">-</span><span style="color: #40a070">1</span>)<span style="color: #666666">*</span><span style="color: #40a070">0.5</span>))
        n1_coor <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(n1) <span style="color: #60a0b0; font-style: italic"># til å regne ut verdiene til cosinus-ene</span>

        n2 <span style="color: #666666">=</span> <span style="color: #007020">int</span>(<span style="color: #007020">round</span>((sz<span style="color: #666666">-</span><span style="color: #40a070">1</span>)<span style="color: #666666">*</span>(<span style="color: #40a070">1</span><span style="color: #666666">-</span>alpha<span style="color: #666666">*</span><span style="color: #40a070">0.5</span>)))

        n3_coor <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(n2,N)

        h[i,:n1] <span style="color: #666666">=</span> <span style="color: #40a070">0.5</span><span style="color: #666666">*</span>(<span style="color: #40a070">1</span> <span style="color: #666666">+</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>(<span style="color: #40a070">2</span><span style="color: #666666">*</span>n1_coor<span style="color: #666666">/</span>(alpha<span style="color: #666666">*</span>(sz<span style="color: #666666">-</span><span style="color: #40a070">1</span>)) <span style="color: #666666">-</span> <span style="color: #40a070">1</span>)))
        h[i,n1:n2] <span style="color: #666666">=</span> <span style="color: #40a070">1</span>
        h[i,n2:] <span style="color: #666666">=</span> <span style="color: #40a070">0.5</span><span style="color: #666666">*</span>(<span style="color: #40a070">1</span> <span style="color: #666666">+</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>(<span style="color: #40a070">2</span><span style="color: #666666">*</span>n3_coor<span style="color: #666666">/</span>(alpha<span style="color: #666666">*</span>(sz<span style="color: #666666">-</span><span style="color: #40a070">1</span>)) <span style="color: #666666">-</span> <span style="color: #40a070">2</span><span style="color: #666666">/</span>alpha <span style="color: #666666">+</span> <span style="color: #40a070">1</span>)))

    <span style="color: #007020; font-weight: bold">return</span> np<span style="color: #666666">.</span>outer(h[<span style="color: #40a070">0</span>,:N],h[<span style="color: #40a070">1</span>,:M])


img <span style="color: #666666">=</span> imread(<span style="color: #4070a0">&#39;lena.png&#39;</span>,flatten<span style="color: #666666">=</span><span style="color: #007020">True</span>)

w <span style="color: #666666">=</span> tukeywin(img<span style="color: #666666">.</span>shape,<span style="color: #40a070">0.5</span>)
img_w <span style="color: #666666">=</span> img<span style="color: #666666">*</span>w

img_fft <span style="color: #666666">=</span> fftshift(fft2(img))
img_w_fft <span style="color: #666666">=</span> fftshift(fft2(img_w))

plt<span style="color: #666666">.</span>figure()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>log(np<span style="color: #666666">.</span>abs(img_fft) <span style="color: #666666">+</span> <span style="color: #40a070">1</span>),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&quot;Spekter til bildet uten vindu&quot;</span>)

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>log(np<span style="color: #666666">.</span>abs(img_w_fft)<span style="color: #666666">+</span><span style="color: #40a070">1</span>),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&quot;Spekter til bildet med vindu&quot;</span>)

plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
Programmet kan lastes ned <a href="https://github.com/krisbhei/INF2310/blob/master/Uke9/oppgave5.py" target="_self">her</a>.

<h1 id="___sec3" class="anchor">Oppgave 7 </h1>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "friendly" -->
<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">numpy</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">np</span>
<span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.pyplot</span> <span style="color: #007020; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">plt</span>
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">scipy.misc</span> <span style="color: #007020; font-weight: bold">import</span> imread
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">numpy.fft</span> <span style="color: #007020; font-weight: bold">import</span> fft2,ifft2,fftshift
<span style="color: #007020; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">functools</span> <span style="color: #007020; font-weight: bold">import</span> <span style="color: #007020">reduce</span>

img <span style="color: #666666">=</span> imread(<span style="color: #4070a0">&#39;tekna133.png&#39;</span>,flatten<span style="color: #666666">=</span><span style="color: #007020">True</span>)
N,M <span style="color: #666666">=</span> img<span style="color: #666666">.</span>shape

<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">notch_filter</span>(D0,n,zero_freq,P<span style="color: #666666">=</span><span style="color: #40a070">512</span>,Q<span style="color: #666666">=</span><span style="color: #40a070">512</span>):
    num_zero_freq <span style="color: #666666">=</span> zero_freq<span style="color: #666666">.</span>shape[<span style="color: #40a070">0</span>]

    H <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((P,Q))
    n2 <span style="color: #666666">=</span> n<span style="color: #666666">*</span><span style="color: #40a070">2</span>
    <span style="color: #007020; font-weight: bold">for</span> u <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(P):
        <span style="color: #007020; font-weight: bold">for</span> v <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(Q):
            D <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sqrt(((u<span style="color: #666666">-</span>zero_freq[:,<span style="color: #40a070">0</span>])<span style="color: #666666">/</span>(<span style="color: #40a070">0.5</span><span style="color: #666666">*</span>P))<span style="color: #666666">**</span><span style="color: #40a070">2</span><span style="color: #666666">+</span>((v<span style="color: #666666">-</span>zero_freq[:,<span style="color: #40a070">1</span>])<span style="color: #666666">/</span>(Q<span style="color: #666666">*</span><span style="color: #40a070">0.5</span>))<span style="color: #666666">**</span><span style="color: #40a070">2</span>)
            <span style="color: #60a0b0; font-style: italic"># Reduce med (lambda x,y: x*y) ganger hvert element i D .</span>
            H[u,v] <span style="color: #666666">=</span> <span style="color: #007020">reduce</span>((<span style="color: #007020; font-weight: bold">lambda</span> x,y: x<span style="color: #666666">*</span>y),<span style="color: #40a070">1</span><span style="color: #666666">-</span>(<span style="color: #40a070">1</span><span style="color: #666666">/</span>(<span style="color: #40a070">1</span><span style="color: #666666">+</span>(D<span style="color: #666666">/</span>D0)<span style="color: #666666">**</span>(n2))))

    <span style="color: #007020; font-weight: bold">return</span> H

<span style="color: #60a0b0; font-style: italic"># a</span>
img_fft <span style="color: #666666">=</span> fft2(img)
img_fft_pad <span style="color: #666666">=</span> fft2(img,(<span style="color: #40a070">2</span><span style="color: #666666">*</span>N,<span style="color: #40a070">2</span><span style="color: #666666">*</span>M))

plt<span style="color: #666666">.</span>figure()

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">1</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>log(np<span style="color: #666666">.</span>abs(img_fft) <span style="color: #666666">+</span> <span style="color: #40a070">1</span>),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Fourier til bilde u/padding&#39;</span>)

plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">1</span>,<span style="color: #40a070">2</span>,<span style="color: #40a070">2</span>)
plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>log(np<span style="color: #666666">.</span>abs(img_fft_pad) <span style="color: #666666">+</span> <span style="color: #40a070">1</span>),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Fourier til bilde med padding&#39;</span>)

<span style="color: #60a0b0; font-style: italic"># b</span>

u1,v1 <span style="color: #666666">=</span> <span style="color: #40a070">72</span>,<span style="color: #40a070">26</span>
u1_,v1_<span style="color: #666666">=</span> N<span style="color: #666666">-</span>u1,M<span style="color: #666666">-</span>v1 <span style="color: #60a0b0; font-style: italic"># utnytter konjugert symmetri</span>

u2,v2 <span style="color: #666666">=</span> <span style="color: #40a070">25</span>,<span style="color: #40a070">148</span>
u2_,v2_ <span style="color: #666666">=</span> N<span style="color: #666666">-</span>u2,M<span style="color: #666666">-</span>v2

u3,v3 <span style="color: #666666">=</span> <span style="color: #40a070">174</span>,<span style="color: #40a070">74</span>
u3_,v3_ <span style="color: #666666">=</span> N<span style="color: #666666">-</span>u3,M<span style="color: #666666">-</span>v3

u4,v4 <span style="color: #666666">=</span> <span style="color: #40a070">216</span>,<span style="color: #40a070">74</span>
u4_,v4_ <span style="color: #666666">=</span> N<span style="color: #666666">-</span>u4,M<span style="color: #666666">-</span>v4

u1_pad,v1_pad <span style="color: #666666">=</span> u1<span style="color: #666666">*</span><span style="color: #40a070">2</span>,v1<span style="color: #666666">*</span><span style="color: #40a070">2</span>
u1_pad_,v1_pad_<span style="color: #666666">=</span> <span style="color: #40a070">2</span><span style="color: #666666">*</span>N<span style="color: #666666">-</span>u1_pad,<span style="color: #40a070">2</span><span style="color: #666666">*</span>M<span style="color: #666666">-</span>v1_pad <span style="color: #60a0b0; font-style: italic"># utnytter konjugert symmetri</span>

u2_pad,v2_pad <span style="color: #666666">=</span> u2<span style="color: #666666">*</span><span style="color: #40a070">2</span>,v2<span style="color: #666666">*</span><span style="color: #40a070">2</span>
u2_pad_,v2_pad_ <span style="color: #666666">=</span> <span style="color: #40a070">2</span><span style="color: #666666">*</span>N<span style="color: #666666">-</span>u2_pad,<span style="color: #40a070">2</span><span style="color: #666666">*</span>M<span style="color: #666666">-</span>v2_pad

u3_pad,v3_pad <span style="color: #666666">=</span> u3<span style="color: #666666">*</span><span style="color: #40a070">2</span>,v3<span style="color: #666666">*</span><span style="color: #40a070">2</span>
u3_pad_,v3_pad_ <span style="color: #666666">=</span> <span style="color: #40a070">2</span><span style="color: #666666">*</span>N<span style="color: #666666">-</span>u3_pad,<span style="color: #40a070">2</span><span style="color: #666666">*</span>M<span style="color: #666666">-</span>v3_pad

u4_pad,v4_pad <span style="color: #666666">=</span> u4<span style="color: #666666">*</span><span style="color: #40a070">2</span>,v4<span style="color: #666666">*</span><span style="color: #40a070">2</span>
u4_pad_,v4_pad_ <span style="color: #666666">=</span> <span style="color: #40a070">2</span><span style="color: #666666">*</span>N<span style="color: #666666">-</span>u4_pad,<span style="color: #40a070">2</span><span style="color: #666666">*</span>M<span style="color: #666666">-</span>v4_pad

freqs <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([[u1,v1],
                  [u1_,v1_],
                  [u2,v2],
                  [u2_,v2_],
                  [u3,v3],
                  [u3_,v3_],
                  [u4,v4],
                  [u4_,v4_],
                  [u1_pad,v1_pad],
                  [u1_pad_,v1_pad_],
                  [u2_pad,v2_pad],
                  [u2_pad_,v2_pad_],
                  [u3_pad,v3_pad],
                  [u3_pad_,v3_pad_],
                  [u4_pad,v4_pad],
                  [u4_pad_,v4_pad_],])

imgs <span style="color: #666666">=</span> [img_fft,img_fft_pad]

<span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">2</span>):
    H <span style="color: #666666">=</span> notch_filter(<span style="color: #40a070">0.1</span>,<span style="color: #40a070">2</span>,freqs[i<span style="color: #666666">*</span><span style="color: #40a070">8</span>:<span style="color: #40a070">8</span><span style="color: #666666">*</span>(i<span style="color: #666666">+</span><span style="color: #40a070">1</span>)],N<span style="color: #666666">*</span>(i<span style="color: #666666">+</span><span style="color: #40a070">1</span>),M<span style="color: #666666">*</span>(i<span style="color: #666666">+</span><span style="color: #40a070">1</span>))
    img_filt <span style="color: #666666">=</span> H<span style="color: #666666">*</span>imgs[i]

    plt<span style="color: #666666">.</span>figure()

    plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">2</span>,<span style="color: #40a070">3</span>,<span style="color: #40a070">2</span>)
    plt<span style="color: #666666">.</span>imshow(img,cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Det originale bildet&#39;</span>)

    plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">2</span>,<span style="color: #40a070">3</span>,<span style="color: #40a070">4</span>)
    plt<span style="color: #666666">.</span>imshow(H,cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Filteret&#39;</span>)

    plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">2</span>,<span style="color: #40a070">3</span>,<span style="color: #40a070">5</span>)
    plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>log(np<span style="color: #666666">.</span>abs(img_filt)<span style="color: #666666">+</span><span style="color: #40a070">1</span>),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Fourier-spekteret til filtrert bilde&#39;</span>)

    plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">2</span>,<span style="color: #40a070">3</span>,<span style="color: #40a070">6</span>)
    plt<span style="color: #666666">.</span>imshow(np<span style="color: #666666">.</span>abs(ifft2(img_filt)),cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Filtrert bilde&#39;</span>)

img_filt_fft <span style="color: #666666">=</span> np<span style="color: #666666">.</span>abs(ifft2(img_filt))

<span style="color: #60a0b0; font-style: italic"># liten juksekode for å vise fram bildet uten nullutvidet område</span>
plt<span style="color: #666666">.</span>subplot(<span style="color: #40a070">2</span>,<span style="color: #40a070">3</span>,<span style="color: #40a070">6</span>)

plt<span style="color: #666666">.</span>imshow(img_filt_fft[:N,:M],cmap<span style="color: #666666">=</span><span style="color: #4070a0">&#39;gray&#39;</span>,aspect<span style="color: #666666">=</span><span style="color: #4070a0">&#39;auto&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #4070a0">&#39;Filterert nullutvidet bilde, </span><span style="color: #4070a0; font-weight: bold">\n</span><span style="color: #4070a0">kuttet til original størrelse &#39;</span>)

plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
Programmet kan lastes ned <a href="https://github.com/krisbhei/INF2310/blob/master/Uke9/oppgave7.py" target="_self">her</a>.

<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright -->  Made with <a href="https://github.com/hplgit/doconce">DocOnce</a>
</center>


</body>
</html>
    

